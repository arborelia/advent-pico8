pico-8 cartridge // http://www.pico-8.com
version 34
__lua__
#include advent.p8
#include serial.p8

function empty_array(n)
 local arr = {}
 for i=1,n do
  arr[i] = 0
 end
 return arr
end

-- number of days to simulate
ndays = 90

-- tiniest number
ulp = minify(1)

function plot(y,val)
 for c=1,9 do
  local shift=18-c*2
  local v=shl(val,shift)
  if v >= 1 then
   color(c)
   line(0,y,v-1,y)
  end
 end
end

function lanternfish_table()
 local born = empty_array(ndays)
 local totals = empty_array(ndays)
 born[1] = ulp
 
 cls(0)
 for day=1,ndays do
  local fish=born[day]
  plot(day,fish)
  -- print("day "..day..": "..fish)
  for bday=day+9,ndays,7 do
   born[bday] += fish
  end
 end
 
 local total=0
 for day=1,ndays do
  total += born[day]
  totals[day] = total
 end
 return totals
end

totals = lanternfish_table()

function count_fish(offsets)
 local total = 0
 for f in all(offsets) do
  total += totals[89-f]
 end
 return inttext(total)
end

test(
 count_fish({3,4,3,1,2}),
 "5934",
 "small example"
)

input = split(read_lines()[1], ",")
check(count_fish(input))

__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
0bb0bb00000007707770777070007000000077707070777077707770700077700000000077707770777070700000000000000000000000000000000000000000
1bbbbb00000070007770707070007000000070007070707077707070700070000700000070007070007070700000000000000000000000000000000000000000
1bbbbb00000077707070777070007000000077000700777070707770700077000000000077707770077077700000000000000000000000000000000000000000
10bbb000000000707070707070007000000070007070707070707000700070000700000000700070007000700000000000000000000000000000000000000000
100b0000000077007070707077707770000077707070707070707000777077700000000077700070777000700000000000000000000000000000000000000000
10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77707770777077007070000077700770777000007770770077707070777000000000000000000000000000000000000000000000000000000000000000000000
70707000707070707070000070007070707000000700707070707070070000000000000000000000000000000000000000000000000000000000000000000000
77007700777070707770000077007070770000000700707077707070070000000000000000000000000000000000000000000000000000000000000000000000
70707000707070700070000070007070707000000700707070007070070000000000000000000000000000000000000000000000000000000000000000000000
71707770707077707770000070007700707000007770707070000770070000000000000000000000000000000000000000000000000000000000000000000000
11000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77700000700077707700777007700000777077707770770000000000000000000000000000000000000000000000000000000000000000000000000000000000
21710000700007007070700070000000707070007070707000000000000000000000000000000000000000000000000000000000000000000000000000000000
77710000700007007070770077700000770077007770707000000000000000000000000000000000000000000000000000000000000000000000000000000000
71110000700007007070700000700000707070007070707000000000000000000000000000000000000000000000000000000000000000000000000000000000
77710000777077707070777077000000707077707070777000000000000000000000000000000000000000000000000000000000000000000000000000000000
21110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2bb1b0b0bbb00bb0b0b00000bbb0bb000bb0b0b0bbb0bbb000000000bbb0bbb0bbb0bbb0bb00b0b0000000000000000000000000000000000000000000000000
b111b0b0b000b000b0b00000b0b0b0b0b000b0b0b000b0b00b00000000b0b000b0b000b00b00b0b0000000000000000000000000000000000000000000000000
b111bbb0bb00b000bb000000bbb0b0b0bbb0b0b0bb00bb00000000000bb0bbb0bbb0bbb00b00bbb0000000000000000000000000000000000000000000000000
b111b1b0b000b000b0b00000b0b0b0b000b0bbb0b000b0b00b00000000b000b0b0b0b0000b0000b0000000000000000000000000000000000000000000000000
2bb1b1b1bbb00bb0b0b00000b0b0b0b0bb00bbb0bbb0b0b000000000bbb0bbb0bbb0bbb0bbb000b0000000000000000000000000000000000000000000000000
22111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
22111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
22111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
22111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
22211111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
22211111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
22211111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
22211111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
32221111111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
32221111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
32221111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
32222111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
32222111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
32222211111111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
32222211111111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
32222221111111111111111111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33222222111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33222222111111111111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33222222211111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33222222211111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33322222222211111111111111111111111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000
33322222222211111111111111111111111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000
33322222222222111111111111111111111111111111111111111111110000000000000000000000000000000000000000000000000000000000000000000000
33322222222222111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000
43332222222222221111111111111111111111111111111111111111111111110000000000000000000000000000000000000000000000000000000000000000
43332222222222222111111111111111111111111111111111111111111111111111110000000000000000000000000000000000000000000000000000000000
43332222222222222111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000
43333222222222222222211111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000
43333222222222222222211111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000
43333322222222222222222222111111111111111111111111111111111111111111111111111111111111111111111111111111110000000000000000000000
43333322222222222222222222111111111111111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000
43333332222222222222222222222211111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111000000
44333333222222222222222222222222111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
44333333222222222222222222222222211111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
44333333322222222222222222222222222222211111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
44333333322222222222222222222222222222211111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
44433333333322222222222222222222222222222222222211111111111111111111111111111111111111111111111111111111111111111111111111111111
44433333333322222222222222222222222222222222222211111111111111111111111111111111111111111111111111111111111111111111111111111111
44433333333333222222222222222222222222222222222222222222211111111111111111111111111111111111111111111111111111111111111111111111
44433333333333222222222222222222222222222222222222222222222111111111111111111111111111111111111111111111111111111111111111111111
54443333333333332222222222222222222222222222222222222222222222221111111111111111111111111111111111111111111111111111111111111111
54443333333333333222222222222222222222222222222222222222222222222222222111111111111111111111111111111111111111111111111111111111
54443333333333333322222222222222222222222222222222222222222222222222222221111111111111111111111111111111111111111111111111111111
54444333333333333333322222222222222222222222222222222222222222222222222222222222222222211111111111111111111111111111111111111111
54444333333333333333322222222222222222222222222222222222222222222222222222222222222222211111111111111111111111111111111111111111
54444433333333333333333333222222222222222222222222222222222222222222222222222222222222222222222222222222211111111111111111111111
54444433333333333333333333222222222222222222222222222222222222222222222222222222222222222222222222222222222111111111111111111111
54444443333333333333333333333322222222222222222222222222222222222222222222222222222222222222222222222222222222222222222221111111
55444444333333333333333333333333222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
55444444333333333333333333333333332222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
55444444433333333333333333333333333333322222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
55444444443333333333333333333333333333332222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
55544444444433333333333333333333333333333333333322222222222222222222222222222222222222222222222222222222222222222222222222222222
55544444444433333333333333333333333333333333333322222222222222222222222222222222222222222222222222222222222222222222222222222222
55544444444444333333333333333333333333333333333333333333222222222222222222222222222222222222222222222222222222222222222222222222
55544444444444333333333333333333333333333333333333333333333222222222222222222222222222222222222222222222222222222222222222222222
65554444444444443333333333333333333333333333333333333333333333332222222222222222222222222222222222222222222222222222222222222222
65554444444444444433333333333333333333333333333333333333333333333333333322222222222222222222222222222222222222222222222222222222
65554444444444444433333333333333333333333333333333333333333333333333333333222222222222222222222222222222222222222222222222222222
65555444444444444444433333333333333333333333333333333333333333333333333333333333333333322222222222222222222222222222222222222222
65555444444444444444443333333333333333333333333333333333333333333333333333333333333333332222222222222222222222222222222222222222
65555544444444444444444444333333333333333333333333333333333333333333333333333333333333333333333333333333222222222222222222222222
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

